<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Juego A√±os 70</title>
  <link href="https://fonts.googleapis.com/css2?family=Rubik+Vinyl&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <style>
    input { text-transform: uppercase; }
    .pregunta-img { max-width: 80%; border: 4px solid #fff; border-radius: 12px; margin: 1rem auto; display: block; }
    iframe.spotify-player { margin: 1rem 0; border: none; border-radius: 12px; }
    .pregunta-texto, .pista-texto { font-family: 'Rubik', sans-serif; font-size: 18px; color: black; line-height: 1.5; margin: 0.5rem 0; }
    #mensaje, #mensajeClave { margin-top: 1rem; font-size: 18px; }
    #mensajeClave { margin-bottom: 1rem; }
    .intro-cancion { font-weight: bold; font-size: 20px; color: #333; }
    .mensaje-correcto { font-weight: bold; font-size: 20px; margin-bottom: 1rem; color: green; }
    .seleccion-num { font-weight: bold; margin-left: 10px; }
    .num-btn { margin: 0 5px; }
  </style>
</head>
<body>
  <div class="page-enter"></div>
  <div id="contenedor"></div>

<script>
const preguntas = [
  { texto: "1. Foto de la √©poca‚Ä¶ ¬øSabes qui√©n son?", respuestas: ["JULIO IGLESIAS","ISABEL PREYSLER"], pista: "BUSCA EN MI PARA√çSO...", clave: "SOL", tema: "groovy1", imagen: "img/boda.jpeg"},
  {
    versiones: {
      1: { texto: `<span class="intro-cancion">¬°¬°Hora de cantar!!<br>Libre Como el Sol cuando amanece <br>Yo soy libre como el mar <br>Libre Como el ave que escap√≥ de su prisi√≥n <br>Y puede, al fin, volar <br>Libre Como el viento que recoge mi lamento y mi pesar <br>Camino sin cesar <br>Detr√°s de la verdad <br>Y sabr√© lo que es al fin, la ____</span>`, respuesta: "LIBERTAD" },
      2: { texto: `<span class="intro-cancion">¬°¬°Hora de cantar!!<br>Hay una chica que es igual <br>Pero distinta a las dem√°s <br>La veo todas las noches <br>Por la playa pasear <br>Y no s√© de d√≥nde viene <br>Y no s√© a d√≥nde va <br>Hace tiempo que sue√±o con ella <br>Y solo s√© que se llama ____</span>`, respuesta: "NOELIA" },
      3: { texto: `<span class="intro-cancion">¬°¬°Hora de cantar!!<br>De d√≠a vivir√© <br>Pensando en tus sonrisas <br>De noche las estrellas me acompa√±ar√°n <br>Ser√°s como una luz <br>Que alumbre en mi camino <br>Me voy, pero te juro que ma√±ana volver√© <br>Al partir, un beso y una flor <br>Un te quiero, una caricia y un adi√≥s <br>Es ligero equipaje <br>Para tan largo viaje <br>Las penas pesan en el ____</span>`, respuesta: "CORAZ√ìN" },
      4: { texto: `<span class="intro-cancion">¬°¬°Hora de cantar!!<br>Donde brilla el tibio sol <br>Con un nuevo fulgor <br>Dorando las arenas <br>Donde el aire es limpio a√∫n <br>Bajo la suave luz <br>De las estrellas <br>Donde el fuego se hace amor <br>El r√≠o es hablador <br>Y el monte selva <br>Hoy encontr√© un lugar <br>Para los dos en esta nueva ____</span>`, respuesta: "TIERRA" },
      5: { texto: `<span class="intro-cancion">¬°¬°Hora de cantar!!<br>Te quiero vida m√≠a, te quiero noche y d√≠a <br>No he querido nunca as√≠, te quiero con ternura <br>Con miedo, con locura, solo vivo para ti <br>Yo te ser√© siempre fiel, pues para m√≠ quiero en flor <br>Ese clavel de tu piel y de tu ____</span>`, respuesta: "AMOR" }
    }, pista: "BUSCA DETR√ÅS DE MI ALMA....", clave: "LUNA", tema: "groovy2"
  },
  { texto: "3. Escuchar un trozo de canci√≥n y decir qui√©n la canta?", respuesta: "JUAN PARDO", pista: "BUSCA EN UN SALVAVIDAS.", clave: "ESTRELLA", tema: "groovy3", audio: "cancion.m4a", inicio: 75 },
  { texto: "4. ¬øA qu√© ol√≠an los hombres en Espa√±a? - Andros - Nenuco - Var√≥n Dandy", respuesta: "VAR√ìN DANDY", pista: "BUSCA EN UN POSTE QUE TENGA MUCHAS BANDERAS", clave: "MARIPOSA", tema: "groovy4" },
  { texto: "5. ¬øC√≥mo se llamaban los payasos de la tele?", respuestas: ["GABI","FOFO","MILIKI"], pista: "BUSCA LA CLAVE EN UNA MACETA.", clave: "FLOR", tema: "groovy5" },
  { texto: "6. Hula hoop, prueba realizada", accion: true, pista: "BUSCA LA CLAVE EN UNA MACETA.", clave: "MAR", tema: "groovy6", youtube: "https://www.youtube.com/watch?v=iK1cgkeRiXE" },
  { texto: `7. ¬øCon qu√© se divert√≠an los ni√±os en esa √©poca?<br><span style="font-size:22px; letter-spacing:6px;">C _ N _ _ _ _</span><br><button id="btnPista" type="button">Pista</button><div id="cajaPista" style="display:none; margin-top:10px;"><img src="img/ninios.png" alt="Pista" style="max-width:250px; border:2px solid #333; border-radius:8px;"></div>`, respuesta: "CINEXIN", pista: "BUSCA LA CLAVE EN UNA MACETA.", clave: "ARCOIRIS", tema: "groovy7" },
  { texto: "8. Se declar√≥ por primera vez el 8 de marzo como D√≠a internacional de la mujer en el a√±o... <br>-1978 <br>-1975 <br>-1973", respuesta: "1975", pista: "BUSCA LA CLAVE EN UNA MACETA.", clave: "PAZ", tema: "groovy8" },
  { texto: "9. Qu√© exitosa pel√≠cula se estrenaba en esta d√©cada. <br>Cazafantasmas <br>Star wars <br>Terminator", respuesta: "Star wars", pista: "BUSCA LA CLAVE EN UNA MACETA.", clave: "LUZ", tema: "groovy1" },
  { texto: "10. En el panel de fotos, hay tres im√°genes de beb√©s. Ten√©is que decir qui√©n es qui√©n: <br>Detr√°s cada foto tiene un n√∫mero", nombres: true, pista: "BUSCA LA CLAVE EN EL PANEL DE FOTOS.", clave: "FAMILIA", tema: "groovy2" }
];

const ordenEquipos = {1:[0,1,2,3,4,5,6,7,8,9],2:[1,2,3,4,5,6,7,8,9,0],3:[2,3,4,5,6,7,8,9,0,1],4:[3,4,5,6,7,8,9,0,1,2],5:[4,5,6,7,8,9,0,1,2,3],6:[5,6,7,8,9,0,1,2,3,4],7:[6,7,8,9,0,1,2,3,4,5],8:[7,8,9,0,1,2,3,4,5,6]};

let equipo = parseInt(localStorage.getItem("equipo")) || 1; // ahora n√∫mero
let indice = parseInt(localStorage.getItem("indicePregunta")) || 0;
const orden = ordenEquipos[equipo];

function mostrarPregunta(){
  if(!orden || indice>=orden.length){
    document.getElementById("contenedor").innerHTML=`<h2>üåº ¬°Juego terminado! üåº</h2><p>¬°Buen trabajo, Equipo ${equipo}!</p>`;
    document.body.className="";
    return;
  }

  const actualPregunta = preguntas[orden[indice]];
  if(!actualPregunta) return;

  const actual = actualPregunta.versiones ? actualPregunta.versiones[equipo] : actualPregunta; // <-- correcci√≥n

  document.body.className = actual.tema;

  let contenidoExtra = "";
  if(actual.imagen) contenidoExtra=`<img src="${actual.imagen}" class="pregunta-img">`;
  if(actual.youtube) contenidoExtra+=`<iframe width="560" height="315" src="${actual.youtube.replace("watch?v=","embed/")}" allowfullscreen></iframe>`;
  if(actual.accion) contenidoExtra+=`<button id="btnAccion">Prueba realizada</button>`;
  if(actual.audio) contenidoExtra+=`<audio id="audioPregunta" controls><source src="${actual.audio}" type="audio/mp3">Tu navegador no soporta audio.</audio>`;

  let formHTML = '';
  if(!actual.accion){
    if(actual.nombres){
      formHTML = `
        <form id="form-pregunta">
          <div><label>Anni:</label>
            <button type="button" class="num-btn" data-nombre="ANNI" data-num="1">1</button>
            <button type="button" class="num-btn" data-nombre="ANNI" data-num="2">2</button>
            <button type="button" class="num-btn" data-nombre="ANNI" data-num="3">3</button>
            <span class="seleccion-num" id="selANNI"></span>
          </div>
          <div><label>Mayte:</label>
            <button type="button" class="num-btn" data-nombre="MAYTE" data-num="1">1</button>
            <button type="button" class="num-btn" data-nombre="MAYTE" data-num="2">2</button>
            <button type="button" class="num-btn" data-nombre="MAYTE" data-num="3">3</button>
            <span class="seleccion-num" id="selMAYTE"></span>
          </div>
          <div><label>Pilar:</label>
            <button type="button" class="num-btn" data-nombre="PILAR" data-num="1">1</button>
            <button type="button" class="num-btn" data-nombre="PILAR" data-num="2">2</button>
            <button type="button" class="num-btn" data-nombre="PILAR" data-num="3">3</button>
            <span class="seleccion-num" id="selPILAR"></span>
          </div>
          <button type="submit">Enviar</button>
        </form>`;
    } else if(Array.isArray(actual.respuestas)){
      formHTML=`<form id="form-pregunta">`+actual.respuestas.map((_,i)=>`<input type="text" id="respuesta${i+1}" placeholder="Respuesta ${i+1}">`).join('')+`<button type="submit">Enviar</button></form>`;
    } else if(actual.respuesta){
      formHTML=`<form id="form-pregunta"><input type="text" id="respuesta" placeholder="Tu respuesta"><button type="submit">Enviar</button></form>`;
    }
  }

  document.getElementById("contenedor").innerHTML=`
    <h2>Pregunta ${indice+1}</h2>
    <p class="pregunta-texto">${actual.texto}</p>
    ${contenidoExtra}
    ${formHTML}
    <div id="mensaje"></div>
  `;

  if(actual.audio){
    const audioElem=document.getElementById("audioPregunta");
    audioElem.addEventListener('loadedmetadata',()=>{ audioElem.currentTime=75; audioElem.play().catch(()=>{}); });
  }

  if(actual.accion){
    document.getElementById("btnAccion").onclick=()=>mostrarPista(actual);
  }

  const btnPista=document.getElementById("btnPista");
  if(btnPista) btnPista.onclick=()=>document.getElementById("cajaPista").style.display="block";

  const form=document.getElementById("form-pregunta");
  if(form){
    if(actual.nombres){
      const seleccion={ANNI:null,MAYTE:null,PILAR:null};
      form.querySelectorAll(".num-btn").forEach(btn=>{
        btn.addEventListener("click",()=>{
          const nombre=btn.dataset.nombre;
          const num=btn.dataset.num;
          seleccion[nombre]=num;
          document.getElementById("sel"+nombre).textContent=`‚Üí ${num}`;
        });
      });
      form.onsubmit=(e)=>{
        e.preventDefault();
        const correcto=(seleccion.ANNI==="3" && seleccion.MAYTE==="1" && seleccion.PILAR==="2");
        if(correcto){ ocultarPregunta(); mostrarPista(actual); }
        else document.getElementById("mensaje").innerHTML=`<span>‚ùå Respuesta incorrecta. Intenta de nuevo.</span>`;
      };
    } else if(Array.isArray(actual.respuestas)){
      form.onsubmit=(e)=>{
        e.preventDefault();
        const valores=actual.respuestas.map((_,i)=>document.getElementById(`respuesta${i+1}`).value.trim().toUpperCase());
        const respuestas=actual.respuestas.map(r=>r.toUpperCase());
        const correcto=respuestas.every(r=>valores.includes(r));
        if(correcto){ ocultarPregunta(); mostrarPista(actual); }
        else document.getElementById("mensaje").innerHTML=`<span>‚ùå Respuesta incorrecta. Intenta de nuevo.</span>`;
      };
    } else if(actual.respuesta){
      form.onsubmit=(e)=>{
        e.preventDefault();
        const val=document.getElementById("respuesta").value.trim().toUpperCase();
        const correcto=(val===actual.respuesta.toUpperCase());
        if(correcto){ ocultarPregunta(); mostrarPista(actual); }
        else document.getElementById("mensaje").innerHTML=`<span>‚ùå Respuesta incorrecta. Intenta de nuevo.</span>`;
      };
    }
  }
}

function ocultarPregunta(){
  const contenedor=document.getElementById("contenedor");
  const elementos=contenedor.querySelectorAll("p.pregunta-texto,img.pregunta-img,audio,iframe,form#form-pregunta,button#btnAccion");
  elementos.forEach(el=>el.style.display="none");
}

function mostrarPista(actual){
  document.getElementById("mensaje").innerHTML=`
    <div class="mensaje-correcto">‚úÖ Correcto.</div>
    <div class="pista-texto">${actual.pista}</div><br>
    <form id="form-clave">
      <input type="text" id="clave" placeholder="Introduce la clave encontrada">
      <button type="submit">Desbloquear</button>
    </form>
    <div id="mensajeClave"></div>
  `;
  document.getElementById("form-clave").onsubmit=(ev)=>{
    ev.preventDefault();
    const clave=document.getElementById("clave").value.trim().toUpperCase();
    if(clave===actual.clave.toUpperCase()){
      document.getElementById("mensajeClave").innerHTML=`<div class="mensaje-correcto">‚úÖ ¬°Clave correcta!</div><button onclick="siguiente()">Siguiente pregunta</button>`;
    } else {
      document.getElementById("mensajeClave").innerHTML=`<span>‚ùå Clave incorrecta, revisa la pista.</span>`;
    }
  };
}

function siguiente(){ indice++; localStorage.setItem("indicePregunta",indice); mostrarPregunta(); activarCortina(); }
function activarCortina(){ const cortina=document.createElement("div"); cortina.classList.add("page-enter"); document.body.appendChild(cortina); setTimeout(()=>cortina.remove(),1500); }

mostrarPregunta();
</script>
</body>
</html>
