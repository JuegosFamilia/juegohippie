<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Juego A√±os 70</title>
  <link href="https://fonts.googleapis.com/css2?family=Rubik+Vinyl&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <style>
    input {
      text-transform: uppercase; /* siempre en may√∫sculas */
    }
    .pregunta-img {
      max-width: 80%;
      border: 4px solid #fff;
      border-radius: 12px;
      margin: 1rem auto;
      display: block;
    }
    audio {
      margin: 1rem 0;
    }
    /* Estilo normal para el texto de las preguntas y pistas */
    .pregunta-texto, .pista-texto {
      text-shadow: none !important;
      font-family: 'Rubik', sans-serif;
      font-size: 18px;
      color: black;
      line-height: 1.5;
      margin: 0.5rem 0;
    }
    #mensaje, #mensajeClave {
      margin-top: 1rem; /* espacio entre respuesta y pista */
      font-size: 18px;
    }
    #mensajeClave {
      margin-bottom: 1rem; /* separa del siguiente bot√≥n */
    }
  </style>
</head>
<body>
  <div class="page-enter"></div>
  <div id="contenedor"></div>

  <script>
    const preguntas = [
      {
        texto: "1. Foto de la √©poca‚Ä¶ ¬øSabes qui√©n son?",
        respuestas: ["JULIO IGLESIAS", "ISABEL PREYSLER"],
        pista: "BUSCA EN MI PARA√çSO...",
        clave: "SOL",
        tema: "groovy1",
        imagen: "img/boda.jpeg"
      },
      {
        // Pregunta 2 con versiones seg√∫n el equipo
        versiones: {
          1: {
            texto: `<span class="intro-cancion">¬°¬°Hora de cantar!!<br>
Giraros hacia el resto de los equipos y cantar el trozo de canci√≥n que os ha tocado.<br>
Por lo menos uno de los miembros del equipo tiene que cantar<br></span<br>Libre Como el Sol cuando amanece <br>Yo soy libre como el mar <br>Libre Como el ave que escap√≥ de su prisi√≥n <br>Y puede, al fin, volar <br>Libre Como el viento que recoge mi lamento y mi pesar <br>Camino sin cesar <br>Detr√°s de la verdad <br>Y sabr√© lo que es al fin, la ____`,
            respuesta: "LIBERTAD"
          },
          2: {
            texto: `<span class="intro-cancion">¬°¬°Hora de cantar!!<br>
Giraros hacia el resto de los equipos y cantar el trozo de canci√≥n que os ha tocado.<br>
Por lo menos uno de los miembros del equipo tiene que cantar<br></span><br>Hay una chica que es igual <br>Pero distinta a las dem√°s <br>La veo todas las noches <br>Por la playa pasear <br>Y no s√© de d√≥nde viene <br>Y no s√© a d√≥nde va <br>Hace tiempo que sue√±o con ella <br>Y solo s√© que se llama ____`,
            respuesta: "NOELIA"
          },
          3: {
            texto: `<span class="intro-cancion">¬°¬°Hora de cantar!!<br>
Giraros hacia el resto de los equipos y cantar el trozo de canci√≥n que os ha tocado.<br>
Por lo menos uno de los miembros del equipo tiene que cantar<br></span> <br>De d√≠a vivir√© <br>Pensando en tus sonrisas <br>De noche las estrellas me acompa√±ar√°n <br>Ser√°s como una luz <br>Que alumbre en mi camino <br>Me voy, pero te juro que ma√±ana volver√© <br>Al partir, un beso y una flor <br>Un te quiero, una caricia y un adi√≥s <br>Es ligero equipaje <br>Para tan largo viaje <br>Las penas pesan en el ____`,
            respuesta: "CORAZ√ìN"
          },
          4: {
            texto: `<span class="intro-cancion">¬°¬°Hora de cantar!!<br>
Giraros hacia el resto de los equipos y cantar el trozo de canci√≥n que os ha tocado.<br>
Por lo menos uno de los miembros del equipo tiene que cantar<br></span> <br>Donde brilla el tibio sol <br>Con un nuevo fulgor <br>Dorando las arenas <br>Donde el aire es limpio a√∫n <br>Bajo la suave luz <br>De las estrellas <br>Donde el fuego se hace amor <br>El r√≠o es hablador <br>Y el monte selva <br>Hoy encontr√© un lugar <br>Para los dos en esta nueva ____`,
            respuesta: "TIERRA"
          },
          5: {
            texto: `<span class="intro-cancion">¬°¬°Hora de cantar!!<br>
Giraros hacia el resto de los equipos y cantar el trozo de canci√≥n que os ha tocado.<br>
Por lo menos uno de los miembros del equipo tiene que cantar<br></span> <br>Te quiero vida m√≠a, te quiero noche y d√≠a <br>No he querido nunca as√≠, te quiero con ternura <br>Con miedo, con locura, solo vivo para ti <br>Yo te ser√© siempre fiel, pues para m√≠ quiero en flor <br>Ese clavel de tu piel y de tu ____`,
            respuesta: "AMOR"
          }
        },
        pista: "BUSCA DETR√ÅS DE MI ALMA....",
        clave: "LUNA",
        tema: "groovy2"
      },
      {
        texto: "3. Escuchar un trozo de canci√≥n y decir qui√©n la canta?",
        respuesta: "JUAN PARDO",
        pista: "BUSCA EN UN SALVAVIDAS.",
        clave: "ESTRELLA",
        tema: "groovy3",
        audio: "http://www.miguel-a.es/ECOS/J-PARDO/JuanpardoMiguitarra.wav"
      },
      {
        texto: "4. ¬øA qu√© ol√≠an los hombres en Espa√±a? - Andros - Nenuco - Var√≥n Dandy",
        respuesta: "VAR√≥N DANDY",
        pista: "BUSCA EN UN POSTE QUE TENGA MUCHAS BANDERAS",
        clave: "MARIPOSA",
        tema: "groovy4"
      },
      {
        texto: "5. ¬øC√≥mo se llamaban los payasos de la tele?",
        respuestas: ["GABI", "FOFO", "MILIKI"],
        pista: "BUSCA LA CLAVE EN UNA MACETA.",
        clave: "FLOR",
        tema: "groovy5"
      }
    ];

    const ordenEquipos = {
      1: [0, 1, 2, 3, 4],
      2: [2, 3, 1, 4, 0],
      3: [4, 2, 0, 1, 3],
      4: [1, 4, 3, 0, 2],
      5: [3, 0, 4, 2, 1]
    };

    const equipo = localStorage.getItem("equipo");
    let indice = parseInt(localStorage.getItem("indicePregunta")) || 0;
    const orden = ordenEquipos[equipo];

    function mostrarPregunta() {
      if (indice >= orden.length) {
        document.getElementById("contenedor").innerHTML = `
          <h2>üåº ¬°Juego terminado! üåº</h2>
          <p>¬°Buen trabajo, Equipo ${equipo}!</p>
        `;
        document.body.className = "";
        return;
      }

      const actualPregunta = preguntas[orden[indice]];

      const actual = actualPregunta.versiones
        ? {
          texto: actualPregunta.versiones[equipo].texto,
          respuesta: actualPregunta.versiones[equipo].respuesta,
          pista: actualPregunta.pista,
          clave: actualPregunta.clave,
          tema: actualPregunta.tema
        }
        : actualPregunta;

      document.body.className = actual.tema;

      document.getElementById("contenedor").innerHTML = `
        <h2>Pregunta ${indice + 1}</h2>
        <p class="pregunta-texto">${actual.texto}</p>
        ${actual.imagen ? `<img src="${actual.imagen}" alt="Imagen de la pregunta" class="pregunta-img">` : ""}
        ${actual.audio ? `<audio controls><source src="${actual.audio}" type="audio/wav">Tu navegador no soporta audio.</audio>` : ""}
        <form id="form-pregunta">
          ${Array.isArray(actual.respuestas)
          ? actual.respuestas.map((_, i) =>
            `<input type="text" id="respuesta${i + 1}" placeholder="Respuesta ${i + 1}">`
          ).join("")
          : `<input type="text" id="respuesta" placeholder="Tu respuesta">`
        }
          <button type="submit">Enviar</button>
        </form>
        <div id="mensaje"></div>
      `;

      document.getElementById("form-pregunta").onsubmit = (e) => {
        e.preventDefault();

        if (Array.isArray(actual.respuestas)) {
          const valores = actual.respuestas.map((_, i) =>
            document.getElementById(`respuesta${i + 1}`).value.trim().toUpperCase()
          );

          const respuestas = actual.respuestas.map(r => r.toUpperCase());

          const correcto = respuestas.every(r => valores.includes(r));

          if (correcto) {
            mostrarPista(actual);
          } else {
            document.getElementById("mensaje").innerHTML = `<span>‚ùå Respuesta incorrecta. Intenta de nuevo.</span>`;
          }

        } else {
          const input = document.getElementById("respuesta");
          if (!input) return;

          const valor = input.value.trim().toUpperCase();
          if (valor === actual.respuesta.toUpperCase()) {
            mostrarPista(actual);
          } else {
            document.getElementById("mensaje").innerHTML = `<span>‚ùå Respuesta incorrecta. Intenta de nuevo.</span>`;
          }
        }
      };
    }

    function mostrarPista(actual) {
      document.getElementById("mensaje").innerHTML = `
        <div class="mensaje-correcto">‚úÖ Correcto.</div>
        <div class="pista-texto">${actual.pista}</div><br>
        <form id="form-clave">
          <input type="text" id="clave" placeholder="Introduce la clave encontrada">
          <button type="submit">Desbloquear</button>
        </form>
        <div id="mensajeClave"></div>
      `;
      document.getElementById("form-clave").onsubmit = (ev) => {
        ev.preventDefault();
        const clave = document.getElementById("clave").value.trim().toUpperCase();
        if (clave === actual.clave.toUpperCase()) {
          document.getElementById("mensajeClave").innerHTML = `
            <div class="mensaje-correcto">‚úÖ ¬°Clave correcta!</div>
            <button onclick="siguiente()">Siguiente pregunta</button>
          `;
        } else {
          document.getElementById("mensajeClave").innerHTML = `<span>‚ùå Clave incorrecta, revisa la pista.</span>`;
        }
      };
    }

    function siguiente() {
      indice++;
      localStorage.setItem("indicePregunta", indice);
      mostrarPregunta();
      activarCortina();
    }

    function activarCortina() {
      const cortina = document.createElement("div");
      cortina.classList.add("page-enter");
      document.body.appendChild(cortina);
      setTimeout(() => cortina.remove(), 1500);
    }

    mostrarPregunta();
  </script>
</body>
</html>
