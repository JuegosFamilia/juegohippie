<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Juego A√±os 70</title>
  <link href="https://fonts.googleapis.com/css2?family=Rubik+Vinyl&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <style>
    input { text-transform: uppercase; }
    .pregunta-img { max-width: 80%; border: 4px solid #fff; border-radius: 12px; margin: 1rem auto; display: block; }
    iframe.spotify-player { margin: 1rem 0; border: none; border-radius: 12px; }
    .pregunta-texto, .pista-texto { font-family: 'Rubik', sans-serif; font-size: 18px; color: black; line-height: 1.5; margin: 0.5rem 0; }
    #mensaje, #mensajeClave { margin-top: 1rem; font-size: 18px; }
    #mensajeClave { margin-bottom: 1rem; }
    .intro-cancion { font-weight: bold; font-size: 20px; color: #333; }
    .mensaje-correcto { font-weight: bold; font-size: 20px; margin-bottom: 1rem; color: green; }
  </style>
</head>
<body>
<div class="page-enter"></div>
<div id="contenedor"></div>

<script>
const preguntas = [
  { texto: "1. Foto de la √©poca‚Ä¶ ¬øSabes qui√©n son?", respuestas: ["JULIO IGLESIAS","ISABEL PREYSLER"], pista:"BUSCA EN MI PARA√çSO...", clave:"SOL", tema:"groovy1", imagen:"img/boda.jpeg" },
  { versiones: {
      1:{ texto: `<span class="intro-cancion">¬°¬°Hora de cantar!!</span><br> Libre Como el Sol cuando amanece...`, respuesta:"LIBERTAD" },
      2:{ texto: `<span class="intro-cancion">¬°¬°Hora de cantar!!</span><br> Hay una chica que es igual...`, respuesta:"NOELIA" },
      3:{ texto: `<span class="intro-cancion">¬°¬°Hora de cantar!!</span><br> De d√≠a vivir√© pensando en tus sonrisas...`, respuesta:"CORAZ√ìN" },
      4:{ texto: `<span class="intro-cancion">¬°¬°Hora de cantar!!</span><br> Donde brilla el tibio sol...`, respuesta:"TIERRA" },
      5:{ texto: `<span class="intro-cancion">¬°¬°Hora de cantar!!</span><br> Te quiero vida m√≠a, te quiero noche y d√≠a...`, respuesta:"AMOR" }
    }, pista:"BUSCA DETR√ÅS DE MI ALMA....", clave:"LUNA", tema:"groovy2"
  },
  { texto:"3. Escuchar un trozo de canci√≥n y decir qui√©n la canta?", respuesta:"JUAN PARDO", pista:"BUSCA EN UN SALVAVIDAS.", clave:"ESTRELLA", tema:"groovy3", audio:"cancion.m4a" },
  { texto:"4. ¬øA qu√© ol√≠an los hombres en Espa√±a? - Andros - Nenuco - Var√≥n Dandy", respuesta:"VAR√ìN DANDY", pista:"BUSCA EN UN POSTE QUE TENGA MUCHAS BANDERAS", clave:"MARIPOSA", tema:"groovy4" },
  { texto:"5. ¬øC√≥mo se llamaban los payasos de la tele?", respuestas:["GABI","FOFO","MILIKI"], pista:"BUSCA LA CLAVE EN UNA MACETA.", clave:"FLOR", tema:"groovy5" },
  { texto:"6. Hula hoop, prueba realizada", accion:true, pista:"BUSCA LA CLAVE EN UNA MACETA.", clave:"MAR", tema:"groovy6", youtube:"https://www.youtube.com/watch?v=iK1cgkeRiXE" },
  { texto:`7. ¬øCon qu√© se divert√≠an los ni√±os en esa √©poca?<br>
          <span style="font-size:22px; letter-spacing:6px;">C _ N _ _ _ _</span><br>
          <button id="btnPista" type="button">Pista</button>
          <div id="cajaPista" style="display:none; margin-top:10px;">
            <img src="img/cinecin.jpg" alt="Pista: juguete de los 70" style="max-width:250px; border:2px solid #333; border-radius:8px;">
          </div>`, respuesta:"CINECIN", pista:"BUSCA LA CLAVE EN UNA MACETA.", clave:"ARCOIRIS", tema:"groovy7" },
  { texto:"8. Se declar√≥ por primera vez el 8 de marzo como D√≠a internacional de la mujer en el a√±o...", respuestas:["1978","1975","1973"], multiple:true, pista:"BUSCA LA CLAVE EN UNA MACETA.", clave:"PAZ", tema:"groovy8" },
  { texto:"9. Qu√© exitosa pel√≠cula se estrenaba en esta d√©cada.", respuestas:["Cazafantasmas","Star wars","Terminator"], pista:"BUSCA LA CLAVE EN UNA MACETA.", clave:"LUZ", tema:"groovy1", imagen:"img/boda.jpeg" },
  { texto:"10. En el panel de fotos, hay tres im√°genes de beb√©s. Ten√©is que decir qui√©n es qui√©n:", respuestas:["ANNI","MAYTE","PILAR"], nombres:true, pista:"BUSCA LA CLAVE EN EL PANEL DE FOTOS.", clave:"FAMILIA", tema:"groovy2", imagen:"img/bebes.jpg" }
];

const ordenEquipos = {
  1:[0,1,2,3,4,5,6,7,8,9,10],
  2:[1,2,3,4,5,6,7,8,9,10,0],
  3:[2,3,4,5,6,7,8,9,10,0,1],
  4:[3,4,5,6,7,8,9,10,0,1,2],
  5:[4,5,6,7,8,9,10,0,1,2,3],
  6:[5,6,7,8,9,10,0,1,2,3,4],
  7:[6,7,8,9,10,0,1,2,3,4,5],
  8:[7,8,9,10,0,1,2,3,4,5,6]
};

const equipo = localStorage.getItem("equipo");
let indice = parseInt(localStorage.getItem("indicePregunta")) || 0;
const orden = ordenEquipos[equipo];

function mostrarPregunta() {
  if(indice>=orden.length){
    document.getElementById("contenedor").innerHTML=`<h2>üåº ¬°Juego terminado! üåº</h2><p>¬°Buen trabajo, Equipo ${equipo}!</p>`;
    document.body.className="";
    return;
  }

  const actualPregunta = preguntas[orden[indice]];
  const actual = actualPregunta.versiones ? {
    texto: actualPregunta.versiones[equipo].texto,
    respuesta: actualPregunta.versiones[equipo].respuesta,
    pista: actualPregunta.pista,
    clave: actualPregunta.clave,
    tema: actualPregunta.tema
  } : actualPregunta;

  document.body.className=actual.tema;

  let contenidoExtra="";
  if(actual.imagen) contenidoExtra+=`<img src="${actual.imagen}" class="pregunta-img">`;
  if(actual.youtube) contenidoExtra+=`<iframe width="560" height="315" src="${actual.youtube.replace("watch?v=","embed/")}" allowfullscreen></iframe>`;
  if(actual.accion) contenidoExtra+=`<button id="btnAccion">Prueba realizada</button>`;
  if(actual.audio) contenidoExtra+=`<audio id="audioPregunta" controls><source src="${actual.audio}" type="audio/mp3">Tu navegador no soporta audio.</audio>`;

  document.getElementById("contenedor").innerHTML=`
    <h2>Pregunta ${indice+1}</h2>
    <p class="pregunta-texto">${actual.texto}</p>
    ${contenidoExtra}
    ${!actual.accion ? `
      <form id="form-pregunta">
        ${actual.nombres ? `
          <label>Anni:</label><input type="text" id="respAnni" placeholder="Anni"><br>
          <label>Mayte:</label><input type="text" id="respMayte" placeholder="Mayte"><br>
          <label>Pilar:</label><input type="text" id="respPilar" placeholder="Pilar"><br>
          <button type="submit">Enviar</button>
        ` : Array.isArray(actual.respuestas) ? actual.respuestas.map((_,i)=>`<input type="text" id="respuesta${i+1}" placeholder="Respuesta ${i+1}">`).join("") + `<button type="submit">Enviar</button>` : (actual.respuesta? `<input type="text" id="respuesta" placeholder="Tu respuesta"><button type="submit">Enviar</button>` :"")}
      </form>` : ""}
    <div id="mensaje"></div>
  `;

  // Audio local con inicio en cierto minuto
  if(actual.audio){
    const audioElem=document.getElementById("audioPregunta");
    audioElem.addEventListener('loadedmetadata', ()=>{
      audioElem.currentTime=75; // empieza en 1:15
      audioElem.play().catch(e=>console.log("Audio bloqueado:",e));
    });
  }

  // Bot√≥n hula hoop
  if(actual.accion){
    document.getElementById("btnAccion").onclick=()=>{ mostrarPista(actual); };
  }

  // Bot√≥n pista letra
  const btnPista=document.getElementById("btnPista");
  if(btnPista){
    btnPista.onclick=()=>{ document.getElementById("cajaPista").style.display="block"; };
  }

  // Formulario de respuestas
  const form=document.getElementById("form-pregunta");
  if(form){
    form.onsubmit=(e)=>{
      e.preventDefault();
      let correcto=false;
      if(actual.nombres){
        const a=document.getElementById("respAnni").value.trim().toUpperCase();
        const m=document.getElementById("respMayte").value.trim().toUpperCase();
        const p=document.getElementById("respPilar").value.trim().toUpperCase();
        correcto=(a==="ANNI" && m==="MAYTE" && p==="PILAR");
      } else if(Array.isArray(actual.respuestas)){
        const valores=actual.respuestas.map((_,i)=>document.getElementById(`respuesta${i+1}`).value.trim().toUpperCase());
        const respuestas=actual.respuestas.map(r=>r.toUpperCase());
        correcto=respuestas.every(r=>valores.includes(r));
      } else if(actual.respuesta){
        const val=document.getElementById("respuesta").value.trim().toUpperCase();
        correcto=(val===actual.respuesta.toUpperCase());
      }
      if(correcto) ocultarPregunta(), mostrarPista(actual);
      else document.getElementById("mensaje").innerHTML=`<span>‚ùå Respuesta incorrecta. Intenta de nuevo.</span>`;
    };
  }
}

function ocultarPregunta(){
  const contenedor=document.getElementById("contenedor");
  const elems=contenedor.querySelectorAll("p.pregunta-texto, img.pregunta-img, audio, iframe, form#form-pregunta, button#btnAccion, span");
  elems.forEach(el=>el.style.display="none");
}

function mostrarPista(actual){
  document.getElementById("mensaje").innerHTML=`
    <div class="mensaje-correcto">‚úÖ Correcto.</div>
    <div class="pista-texto">${actual.pista}</div><br>
    <form id="form-clave">
      <input type="text" id="clave" placeholder="Introduce la clave encontrada">
      <button type="submit">Desbloquear</button>
    </form>
    <div id="mensajeClave"></div>
  `;
  document.getElementById("form-clave").onsubmit=(ev)=>{
    ev.preventDefault();
    const clave=document.getElementById("clave").value.trim().toUpperCase();
    if(clave===actual.clave.toUpperCase()){
      document.getElementById("mensajeClave").innerHTML=`<div class="mensaje-correcto">‚úÖ ¬°Clave correcta!</div><button onclick="siguiente()">Siguiente pregunta</button>`;
    }else document.getElementById("mensajeClave").innerHTML=`<span>‚ùå Clave incorrecta, revisa la pista.</span>`;
  };
}

function siguiente(){ indice++; localStorage.setItem("indicePregunta",indice); mostrarPregunta(); activarCortina(); }
function activarCortina(){ const cortina=document.createElement("div"); cortina.classList.add("page-enter"); document.body.appendChild(cortina); setTimeout(()=>cortina.remove(),1500); }

mostrarPregunta();
</script>
</body>
</html>
